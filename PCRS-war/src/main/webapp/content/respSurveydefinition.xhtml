<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<div class="ui-g-1"></div>

	<div class="ui-g-10">

		<h:form id="form">
			<p:tabView value="#{respSurveyDefinitionView.assignedSurveyDefinitionList}" var="def">
				<p:tab title="#{def.name}">
					<p:outputLabel rendered="#{def.surveySections.size() == 0}">Empty message</p:outputLabel>
					<p:repeat var="sectionImpl" value="#{def.surveySections}" >
						<p:dataTable
							value="#{sectionImpl.surveySectionDefinitionBo.surveySectionCompetences}"
							var="comp">
							<f:facet name="header">
								<p:outputLabel value="#{sectionImpl.surveySectionDefinitionBo.surveySectionTitle.title}"></p:outputLabel>
							</f:facet>
							<p:column>
								<h:outputText value="#{var.competenceDescription}" />
							</p:column>
						</p:dataTable>
						<p:commandButton value="#{msgs['respSurveyDefinition.addCompetence']}" 
										process="@this" action="#{respSurveyDefinitionView.newCompetence}"
										update=":addCompetence:addExistingCompetence" oncomplete="PF('addExistingCompetenceDialog').show();" >
							
						</p:commandButton>
					</p:repeat>
					<div class="ui-g" style="margin-top:20px; float: right;">
						<div class="ui-g-12">
							<p:commandButton value="#{msgs['respSurveyDefinition.addNew']}" styleClass="btn btn-outline-primary mx-1"
									process="@this" action="#{respSurveyDefinitionView.newSurveyDefinition}"
									update=":addNewForm:addNewSurveySectionDefinition" oncomplete="PF('addNewSurveySectionDefinitionDialog').show();" >
									<f:setPropertyActionListener value="#{def}" target="#{respSurveyDefinitionView.activeTab}"/>
							</p:commandButton>
							
							<p:commandButton value="#{msgs['respSurveyDefinition.addExisting']}" styleClass="btn btn-primary mx-1"
											process="@this" action="#{respSurveyDefinitionView.newSurveyDefinition}"
											update=":addExistingForm:addExistingSurveySectionDefinition" 
											oncomplete="PF('addExistingSurveySectionDefinitionDialog').show();" >
											<f:setPropertyActionListener value="#{def}" target="#{respSurveyDefinitionView.activeTab}"/>
							</p:commandButton>
						</div>
					</div>
					
				</p:tab>
				
			</p:tabView>
		</h:form>

		<h:form id="addNewForm">
			<div class="ui-g" id="addSurveyDefinition">
				<p:dialog header="#{msgs['respSurveyDefinition.addNew']}"
					widgetVar="addNewSurveySectionDefinitionDialog" modal="true"
					draggable="false" style="width: 200px; height: 200px;">
					<p:outputPanel id="addNewSurveySectionDefinition">

						<div class="ui-g">
							<div class="ui-g-4">
								<p:outputLabel value="#{msgs['respSurveyDefinition.title']}"></p:outputLabel>
							</div>

							<div class="ui-g-8">
								<p:selectOneMenu
									value="#{respSurveyDefinitionView.addedSurveySectionDefinition.surveySectionTitle}"
									converter="surveySectionTitleConverter">
									<f:selectItems
										value="#{respSurveyDefinitionView.surveySectionTitleList}"
										var="sectionTitle" itemLabel="#{sectionTitle.title}"
										itemValue="#{sectionTitle}" />
								</p:selectOneMenu>

							</div>
						</div>

						<div class="ui-g">
							<div class="ui-g-4">
								<p:outputLabel
									value="#{msgs['respSurveyDefinition.sectionStrategy']}" />
							</div>
							<div class="ui-g-8">
								<p:selectOneMenu
									value="#{respSurveyDefinitionView.addedSurveySectionDefinition.surveySectionStrategy}"
									converter="SurveySectionStrategyConverter">
									<f:selectItems
										value="#{respSurveyDefinitionView.surveySectionStrategyList}"
										var="sectionStrategy" itemLabel="#{sectionStrategy.name}"
										itemValue="#{sectionStrategy}" />
								</p:selectOneMenu>

							</div>
						</div>

						<div class="ui-g">
							<div class="ui-g-4">
								<p:outputLabel
									value="#{msgs['respSurveyDefinition.sectionRequirementLevel']}" />
							</div>
							<div class="ui-g-8">
								<p:selectOneMenu
									value="#{respSurveyDefinitionView.requirementLevel}">
									<f:selectItems
										value="#{respSurveyDefinitionView.surveySectionRequirementLevels}"
										var="level" itemLabel="#{level}" itemValue="#{level}" />
								</p:selectOneMenu>

							</div>
						</div>


						<div class="ui-g-2">
							<p:commandButton value="#{msgs['respSurveyDefinition.add']}"
								update=":form"
								action="#{respSurveyDefinitionView.addNewSurveyDefinition}"
								oncomplete="PF('addNewSurveySectionDefinitionDialog').hide();" />
						</div>
					</p:outputPanel>
				</p:dialog>
			</div>
		</h:form>
		
		<h:form id="addExistingForm">
			<div class="ui-g" id="addSurveyDefinition">
				<p:dialog header="#{msgs['respSurveyDefinition.addExisting']}"
					widgetVar="addExistingSurveySectionDefinitionDialog" modal="true"
					draggable="false">
					<p:outputPanel id="addExistingSurveySectionDefinition">

						<div class="ui-g">
							<div class="ui-g-4">
								<p:outputLabel value="#{msgs['respSurveyDefinition.title']}"></p:outputLabel>
							</div>

							<div class="ui-g-8">
								<p:selectOneMenu
									value="#{respSurveyDefinitionView.addedSurveySectionDefinition}"
											converter="SurveySectionDefinitionBoConverter">
									<f:selectItems
										value="#{respSurveyDefinitionView.existingSurveySectionDefinitionList}"
										var="section" itemLabel="#{section.surveySectionTitle.title}"
										itemValue="#{section}" />
								</p:selectOneMenu>
							</div>
						</div>
						
						<div class="ui-g">
							<div class="ui-g-4">
								<p:outputLabel
									value="#{msgs['respSurveyDefinition.sectionRequirementLevel']}" />
							</div>
							<div class="ui-g-8">
								<p:selectOneMenu
									value="#{respSurveyDefinitionView.requirementLevel}">
									<f:selectItems
										value="#{respSurveyDefinitionView.surveySectionRequirementLevels}"
										var="level" itemLabel="#{level}" itemValue="#{level}" />
								</p:selectOneMenu>

							</div>
						</div>
						
						<div class="ui-g-2">
							<p:commandButton value="#{msgs['respSurveyDefinition.add']}"
								update=":form"
								action="#{respSurveyDefinitionView.addExistingSurveyDefinition}"
								oncomplete="PF('addExistingSurveySectionDefinitionDialog').hide();" />
						</div>
					</p:outputPanel>
				</p:dialog>
			</div>
		</h:form>
		
		
		
		
		<h:form id="addCompetence">
			<div class="ui-g" id="addSurveyDefinition">
				<p:dialog header="#{msgs['respSurveyDefinition.addExisting']}"
					widgetVar="addExistingCompetenceDialog" modal="true"
					draggable="false">
					<p:outputPanel id="addExistingCompetence">
						<div class="ui-g-2">
							<p:commandButton value="#{msgs['respSurveyDefinition.add']}"
								update=":form"
								action="#{respSurveyDefinitionView.addExistingSurveyDefinition}"
								oncomplete="PF('addExistingSurveySectionDefinitionDialog').hide();" />
						</div>
					</p:outputPanel>
				</p:dialog>
			</div>
		</h:form>



	</div>

	<div class="ui-g-1"></div>

</ui:composition>